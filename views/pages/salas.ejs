<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salas - BookNow</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #8D40A4;">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="/assets/logo.booknow.png" alt="BookNow" height="30">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/salas">Salas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/reservas">Minhas Reservas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/calendario">Calendário</a>
                    </li>
                    <li class="nav-item">
                        <button onclick="logout()" class="btn btn-outline-light ms-2">Sair</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-4">
        <h2>Salas Disponíveis</h2>
        <div class="row mt-4" id="salasList">
            <!-- As salas serão carregadas aqui -->
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const supabase = supabase.createClient(
            'https://wkbvhfsrzxtmrqigumeu.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrYnZoZnNyenh0bXJxaWd1bWV1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDY3MDI0MDMsImV4cCI6MjAyMjI3ODQwM30.GQgS85a0JXEFmvHzgXHMnpgqQvQbGIhqpLYmZXE6_Oc'
        );

        // Função para carregar as salas
        async function carregarSalas() {
            try {
                const { data: salas, error } = await supabase
                    .from('salas')
                    .select('*')
                    .order('numero');

                if (error) throw error;

                const salasList = document.getElementById('salasList');
                salasList.innerHTML = salas.map(sala => `
                    <div class="col-md-4 mb-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Sala ${sala.numero}</h5>
                                <p class="card-text">
                                    <strong>Capacidade:</strong> ${sala.capacidade} pessoas<br>
                                    <strong>Recursos:</strong> ${sala.recursos.join(', ')}
                                </p>
                                <a href="/reservas/nova?sala=${sala.id}" class="btn btn-primary">Reservar</a>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Erro ao carregar salas:', error);
            }
        }

        // Função de logout
        async function logout() {
            try {
                await supabase.auth.signOut();
                localStorage.removeItem('accessToken');
                document.cookie = 'accessToken=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT';
                window.location.href = '/';
            } catch (error) {
                console.error('Erro ao fazer logout:', error);
            }
        }

        // Carrega as salas quando a página carregar
        document.addEventListener('DOMContentLoaded', carregarSalas);
    </script>
</body>
</html> 